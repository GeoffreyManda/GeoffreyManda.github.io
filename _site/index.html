<!DOCTYPE html>
<html lang="en"><script src="https://d3js.org/d3.v7.min.js"></script> <body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Geoffrey Manda | Data Scientist</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/">Geoffrey Manda</a><a class="page-link" href="/about/">About</a><a class="page-link" href="/ai-projects/">AI Projects</a><a class="page-link" href="/tutorials/">Tutorials</a><a class="page-link" href="/biostatistics/">Biostatistics</a><a class="page-link" href="/epidemiology/">Epidemiology</a><a class="page-link" href="/contact/">Contact</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <section class="hero-section">
  <div class="hero-animation-container">
    <div id="particle-container"></div>
    <div class="hero-content">
        <h1 class="hero-title">
            <span class="hero-word">Exploring</span>
            <span class="hero-word">the</span>
            <span class="hero-word">Frontiers</span>
            <span class="hero-word">of</span>
            <span class="hero-word">Knowledge</span>
        </h1>
        <p class="hero-subtitle">
            <span class="hero-char-wrapper">
                <span class="hero-chars">A journey through research, innovation, and discovery</span>
            </span>
        </p>
        <div class="hero-buttons">
            <a href="#projects" class="hero-button primary">Explore Projects</a>
            <a href="#about" class="hero-button secondary">Learn More</a>
        </div>
    </div>
    <div class="hero-scroll-indicator">
        <div class="scroll-arrow"></div>
        <div class="scroll-text">Scroll to explore</div>
    </div>
</div>

<style>
    :root {
        --hero-bg: linear-gradient(120deg, #ff7e5f 0%, #6a82fb 100%);
        --hero-text: #fff;
        --hero-accent: #feb47b;
        --hero-secondary: #6a82fb;
        --hero-tertiary: #ff7e5f;
        --hero-depth: #1a1a2a;
        --transition-ease: var(--ease-in-out);
    }

    .dark-mode {
        --hero-bg: linear-gradient(120deg, #23243a 0%, #6a82fb 100%);
        --hero-text: #fff;
        --hero-accent: #feb47b;
    }

    .light-mode {
        --hero-bg: linear-gradient(120deg, #ffecd2 0%, #fcb69f 100%);
        --hero-text: #23243a;
        --hero-accent: #ff7e5f;
    }

    .hero-animation-container {
        position: relative;
        width: 100%;
        height: 100vh;
        min-height: 600px;
        overflow: hidden;
        background: var(--hero-bg);
        color: var(--hero-text);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1;
        backdrop-filter: var(--glass-blur);
        -webkit-backdrop-filter: var(--glass-blur);
    }

    /* Add a dark overlay for contrast */
    .hero-animation-container::before {
        content: '';
        position: absolute;
        inset: 0;
        background: rgba(20, 20, 40, 0.45);
        z-index: 0;
    }

    #particle-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
    }

    .hero-content {
        position: relative;
        z-index: 2;
        text-align: center;
        max-width: 800px;
        padding: 0 20px;
        opacity: 0;
        color: #fff;
        text-shadow: 0 2px 16px rgba(0,0,0,0.7);
    }

    .hero-title {
        font-size: 3.5rem;
        font-weight: 800;
        line-height: 1.2;
        margin-bottom: 1.5rem;
        overflow: hidden;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        font-family: 'Inter', 'SF Pro Display', Arial, sans-serif;
        letter-spacing: -1px;
    }

    .hero-word {
        display: inline-block;
        margin: 0 0.5rem;
        opacity: 0;
        transform: translateY(100%);
        background: linear-gradient(90deg, #ff7e5f, #feb47b, #6a82fb);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        background-size: 200% auto;
        animation: gradient-shift 8s linear infinite;
    }

    .hero-subtitle {
        font-size: 1.25rem;
        font-weight: 300;
        line-height: 1.6;
        margin-bottom: 2.5rem;
        opacity: 0;
        color: #fff;
        text-shadow: 0 1px 8px rgba(0,0,0,0.5);
    }

    .hero-char-wrapper {
        display: block;
        overflow: hidden;
    }

    .hero-chars {
        display: block;
        transform: translateY(100%);
    }

    .hero-buttons {
        display: flex;
        justify-content: center;
        gap: 1rem;
        opacity: 0;
    }

    .hero-button {
        display: inline-block;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        font-weight: 600;
        letter-spacing: 0.5px;
        text-decoration: none;
        transition: all 0.3s var(--transition-ease);
        position: relative;
        overflow: hidden;
        font-size: 1.1rem;
        box-shadow: 0 4px 24px rgba(0,0,0,0.12);
    }

    .hero-button.primary {
        background: linear-gradient(90deg, #ff7e5f, #feb47b);
        color: #fff;
        border: none;
    }

    .hero-button.secondary {
        border: 2px solid #fff;
        color: #fff;
        background: transparent;
    }

    .hero-button:before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: width 0.6s ease, height 0.6s ease;
    }

    .hero-button:hover:before {
        width: 300px;
        height: 300px;
    }

    .hero-button:hover {
        transform: translateY(-2px) scale(1.04);
        box-shadow: 0 8px 32px rgba(249, 115, 22, 0.2);
    }

    .hero-scroll-indicator {
        position: absolute;
        bottom: 40px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        flex-direction: column;
        align-items: center;
        opacity: 0;
        z-index: 2;
    }

    .scroll-arrow {
        width: 20px;
        height: 20px;
        border-right: 2px solid var(--hero-accent);
        border-bottom: 2px solid var(--hero-accent);
        transform: rotate(45deg);
        margin-bottom: 8px;
        animation: scrollArrow 2s infinite;
    }

    .scroll-text {
        font-size: 0.8rem;
        letter-spacing: 1px;
        color: var(--hero-accent);
    }

    @keyframes scrollArrow {
        0% {
            opacity: 0;
            transform: rotate(45deg) translate(-5px, -5px);
        }
        50% {
            opacity: 1;
        }
        100% {
            opacity: 0;
            transform: rotate(45deg) translate(5px, 5px);
        }
    }

    @media (max-width: 768px) {
        .hero-title {
            font-size: 2.5rem;
        }
        .hero-subtitle {
            font-size: 1rem;
        }
        .hero-buttons {
            flex-direction: column;
            width: 100%;
            max-width: 300px;
            margin: 0 auto;
        }
    }

    .particle {
        position: absolute;
        border-radius: 50%;
        background: linear-gradient(45deg, 
            rgba(249, 115, 22, 0.1) 0%,
            rgba(168, 85, 247, 0.1) 100%);
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        pointer-events: none;
    }

    @keyframes gradient-shift {
        to {
            background-position: 200% center;
        }
    }
</style>

<!-- Include GSAP at the end of the body -->
<script>
    // Wait for GSAP to be loaded
    function waitForGSAP() {
        if (window.gsap) {
            initHeroAnimation();
        } else {
            setTimeout(waitForGSAP, 100);
        }
    }

    // Create particles
    function createParticles() {
        const container = document.getElementById('particle-container');
        const particleCount = window.innerWidth < 768 ? 50 : 100;
        
        for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            // Random properties
            const size = Math.random() * 4 + 1;
            const posX = Math.random() * 100;
            const posY = Math.random() * 100;
            const opacity = Math.random() * 0.5 + 0.1;
            const duration = Math.random() * 60 + 30;
            const delay = Math.random() * 10;
            
            // Apply styles
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;
            particle.style.left = `${posX}%`;
            particle.style.top = `${posY}%`;
            particle.style.opacity = opacity;
            
            container.appendChild(particle);
            
            // Animate with GSAP
            gsap.to(particle, {
                x: `random(-100, 100)`,
                y: `random(-100, 100)`,
                opacity: `random(0.1, 0.5)`,
                duration: duration,
                repeat: -1,
                yoyo: true,
                ease: "sine.inOut",
                delay: delay
            });
        }
    }

    function initHeroAnimation() {
        // Initialize GSAP animations
        const tl = gsap.timeline({defaults: {ease: "power3.out"}});
        
        // Create particles
        createParticles();
        
        // Make content visible first
        gsap.set(".hero-content", {opacity: 1});
        
        // Animate title words
        tl.to(".hero-word", {
            opacity: 1, 
            y: 0, 
            duration: 0.8, 
            stagger: 0.1
        });
        
        // Animate subtitle
        tl.to(".hero-chars", {
            y: 0, 
            duration: 0.8, 
            stagger: 0.05
        }, "-=0.4");
        
        // Animate buttons
        tl.to(".hero-buttons", {
            opacity: 1, 
            duration: 0.6
        }, "-=0.2");
        
        // Animate scroll indicator
        tl.to(".hero-scroll-indicator", {
            opacity: 1, 
            duration: 0.6
        }, "-=0.2");
        
        // Floating effect for the content
        gsap.to(".hero-content", {
            y: 10,
            duration: 2,
            repeat: -1,
            yoyo: true,
            ease: "sine.inOut"
        });
        
        // Interactive hover effect for buttons
        const buttons = document.querySelectorAll('.hero-button');
        buttons.forEach(button => {
            button.addEventListener('mouseenter', () => {
                gsap.to(button, {
                    scale: 1.05,
                    duration: 0.3
                });
            });
            
            button.addEventListener('mouseleave', () => {
                gsap.to(button, {
                    scale: 1,
                    duration: 0.3
                });
            });
        });
        
        // Interactive effect for hero container
        const heroContainer = document.querySelector('.hero-animation-container');
        heroContainer.addEventListener('mousemove', (e) => {
            const xPos = (e.clientX / window.innerWidth - 0.5) * 20;
            const yPos = (e.clientY / window.innerHeight - 0.5) * 20;
            
            gsap.to(".hero-content", {
                x: xPos,
                y: yPos,
                duration: 1,
                ease: "power1.out"
            });
            
            gsap.to("#particle-container", {
                x: xPos * 0.5,
                y: yPos * 0.5,
                duration: 2,
                ease: "power1.out"
            });
        });
    }

    // Check if we need to load GSAP
    function loadGSAP() {
        if (!window.gsap) {
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js';
            script.onload = waitForGSAP;
            document.body.appendChild(script);
        } else {
            waitForGSAP();
        }
    }

    // Initialize when document is loaded
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadGSAP);
    } else {
        loadGSAP();
    }
</script>


</section>

<div class="home-content">
  <section class="hero card glassy">
  <div class="hero-content">
    <h1>Geoffrey Manda</h1>
    <h2>Data Science &amp; AI Research</h2>
    <p>Advancing healthcare analytics through statistical innovation</p>
    <div class="hero-cta">
      <a href="#featured-work" class="btn-primary hero-button primary">Explore My Work</a>
      <a href="contact" class="btn-secondary hero-button secondary">Get in Touch</a>
    </div>
  </div>
  <div class="hero-image card-image glassy">
    <!-- Placeholder for hero image -->
    <img src="assets/images/hero-placeholder.jpg" alt="Data visualization concept" />
  </div>
</section>

<section id="featured-work" class="featured-section card glassy">
  <h2>Featured Work</h2>
  <div class="feature-grid">
    <!-- Feature Card 1 -->
    <div class="feature-card card glassy">
      <div class="feature-icon icon-ios">
        <img src="/assets/icons/ai-icon.svg" alt="AI Icon" />
      </div>
      <h3>AI in Climate Modeling</h3>
      <p>Leveraging deep learning to improve climate prediction accuracy</p>
      <a href="ai-projects#climate-modeling" class="feature-link btn-secondary">View Project →</a>
    </div>
    <!-- Feature Card 2 -->
    <div class="feature-card card glassy">
      <div class="feature-icon icon-ios">
        <img src="/assets/icons/stats-icon.svg" alt="Statistics Icon" />
      </div>
      <h3>Survival Analysis</h3>
      <p>Statistical models for time-to-event data in healthcare outcomes</p>
      <a href="biostatistics#survival-analysis" class="feature-link btn-secondary">View Project →</a>
    </div>
    <!-- Feature Card 3 -->
    <div class="feature-card card glassy">
      <div class="feature-icon icon-ios">
        <img src="/assets/icons/research-icon.svg" alt="Research Icon" />
      </div>
      <h3>Epidemiology Research</h3>
      <p>Disease pattern analysis and population health metrics</p>
      <a href="epidemiology" class="feature-link btn-secondary">View Project →</a>
    </div>
  </div>
</section>

<section class="expertise-section card glassy">
  <h2>Areas of Expertise</h2>
  <div class="expertise-grid">
    <div class="expertise-area card glassy">
      <div class="expertise-icon icon-ios">
        <img src="/assets/icons/ai.svg" alt="AI Icon" />
      </div>
      <h3>Artificial Intelligence</h3>
      <p>Machine learning applications in healthcare and climate science, policy development for responsible AI</p>
    </div>
    <div class="expertise-area card glassy">
      <div class="expertise-icon icon-ios">
        <img src="/assets/icons/stats.svg" alt="Statistics Icon" />
      </div>
      <h3>Biostatistics</h3>
      <p>Survival analysis, time-series modeling, and mixed-effects approaches for clinical research</p>
    </div>
    <div class="expertise-area card glassy">
      <div class="expertise-icon icon-ios">
        <img src="/assets/icons/epidemiology.svg" alt="Epidemiology Icon" />
      </div>
      <h3>Epidemiology</h3>
      <p>Research design, causal inference, and statistical methods for population health studies</p>
    </div>
  </div>
</section>

<!-- Research Network Visualization Component -->
<div class="research-network-container">
  <div class="network-controls">
    <div class="search-box">
      <div class="search-header">
        <input type="text" id="node-search" placeholder="Search research areas..." />
        <button class="search-options-btn" aria-label="Search options">⚙️</button>
      </div>
      <div class="search-options">
        <label class="search-option">
          <input type="checkbox" checked="" data-filter="label" /> Search in titles
        </label>
        <label class="search-option">
          <input type="checkbox" checked="" data-filter="description" /> Search in descriptions
        </label>
        <label class="search-option">
          <input type="checkbox" checked="" data-filter="category" /> Search in categories
        </label>
        <div class="search-sort">
          <label>Sort by:</label>
          <select id="search-sort">
            <option value="relevance">Relevance</option>
            <option value="publications">Publications</option>
            <option value="projects">Projects</option>
          </select>
        </div>
      </div>
      <div class="search-results" id="search-results"></div>
    </div>
    <div class="advanced-controls">
      <button class="control-btn" id="export-btn" aria-label="Export data">
        <span class="btn-icon">📊</span>
        <span class="btn-label">Export</span>
      </button>
      <button class="control-btn" id="filter-btn" aria-label="Advanced filters">
        <span class="btn-icon">🔍</span>
        <span class="btn-label">Filters</span>
      </button>
    </div>
    <div class="view-tabs">
      <button class="view-tab active" data-view="network">Network</button>
      <button class="view-tab" data-view="timeline">Timeline</button>
      <button class="view-tab" data-view="clusters">Clusters</button>
    </div>
    <div class="filter-buttons">
      <button class="filter-btn active" data-filter="all">All Areas</button>
      <button class="filter-btn" data-filter="biostatistics">Biostatistics</button>
      <button class="filter-btn" data-filter="epidemiology">Epidemiology</button>
      <button class="filter-btn" data-filter="ai">AI &amp; Policy</button>
    </div>
  </div>
  
  <!-- Advanced filter panel -->
  <div class="filter-panel" style="display: none;">
    <div class="filter-header">
      <h3>Advanced Filters</h3>
      <button class="close-filter" aria-label="Close filters">×</button>
    </div>
    <div class="filter-content">
      <div class="filter-section">
        <h4>Time Period</h4>
        <div class="range-slider">
          <input type="range" id="year-range" min="2018" max="2024" value="2024" step="1" />
          <div class="range-labels">
            <span>2018</span>
            <span id="year-value">2024</span>
          </div>
        </div>
      </div>
      
      <div class="filter-section">
        <h4>Research Impact</h4>
        <div class="impact-filters">
          <label class="filter-checkbox">
            <input type="checkbox" value="high" checked="" /> High Impact
          </label>
          <label class="filter-checkbox">
            <input type="checkbox" value="medium" checked="" /> Medium Impact
          </label>
          <label class="filter-checkbox">
            <input type="checkbox" value="low" checked="" /> Low Impact
          </label>
        </div>
      </div>
      
      <div class="filter-section">
        <h4>Publication Range</h4>
        <div class="range-inputs">
          <input type="number" id="min-pubs" placeholder="Min" min="0" max="100" />
          <span>to</span>
          <input type="number" id="max-pubs" placeholder="Max" min="0" max="100" />
        </div>
      </div>
      
      <div class="filter-section">
        <h4>Collaboration Strength</h4>
        <div class="strength-slider">
          <input type="range" id="collab-strength" min="0" max="100" value="0" />
          <div class="strength-labels">
            <span>All</span>
            <span>Strong</span>
          </div>
        </div>
      </div>
      
      <div class="filter-actions">
        <button class="filter-reset">Reset Filters</button>
        <button class="filter-apply">Apply Filters</button>
      </div>
    </div>
  </div>
  
  <!-- Export options panel -->
  <div class="export-panel" style="display: none;">
    <div class="export-header">
      <h3>Export Options</h3>
      <button class="close-export" aria-label="Close export">×</button>
    </div>
    <div class="export-content">
      <div class="export-section">
        <h4>Format</h4>
        <div class="export-format">
          <label class="format-option">
            <input type="radio" name="format" value="json" checked="" /> JSON
          </label>
          <label class="format-option">
            <input type="radio" name="format" value="csv" /> CSV
          </label>
          <label class="format-option">
            <input type="radio" name="format" value="svg" /> SVG
          </label>
        </div>
      </div>
      
      <div class="export-section">
        <h4>Data Selection</h4>
        <div class="export-options">
          <label class="export-checkbox">
            <input type="checkbox" value="nodes" checked="" /> Research Areas
          </label>
          <label class="export-checkbox">
            <input type="checkbox" value="links" checked="" /> Collaborations
          </label>
          <label class="export-checkbox">
            <input type="checkbox" value="timeline" checked="" /> Timeline
          </label>
          <label class="export-checkbox">
            <input type="checkbox" value="metrics" checked="" /> Metrics
          </label>
        </div>
      </div>
      
      <div class="export-section">
        <h4>Visualization</h4>
        <div class="export-visual">
          <label class="export-checkbox">
            <input type="checkbox" value="current-view" checked="" /> Current View
          </label>
          <label class="export-checkbox">
            <input type="checkbox" value="full-network" /> Full Network
          </label>
        </div>
      </div>
      
      <div class="export-actions">
        <button class="export-cancel">Cancel</button>
        <button class="export-download">Download</button>
      </div>
    </div>
  </div>
  
  <div class="network-visualization">
    <div class="timeline-controls" style="display: none;">
      <div class="timeline-slider">
        <input type="range" id="timeline-slider" min="2018" max="2024" value="2024" step="1" />
        <div class="timeline-labels">
          <span>2018</span>
          <span>2024</span>
        </div>
      </div>
      <div class="timeline-stats">
        <div class="stat-item">
          <span class="stat-label">Active Projects</span>
          <span class="stat-value" id="active-projects">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Publications</span>
          <span class="stat-value" id="total-publications">0</span>
        </div>
      </div>
      <div class="timeline-milestones">
        <h4>Key Milestones</h4>
        <div class="milestone-list"></div>
      </div>
    </div>
    
    <div class="cluster-legend" style="display: none;">
      <h4>Research Clusters</h4>
      <div class="cluster-list"></div>
    </div>
    
    <div class="minimap" id="network-minimap">
      <svg width="150" height="150" viewBox="0 0 800 600">
        <rect class="minimap-bg" width="100%" height="100%" />
        <g class="minimap-nodes"></g>
        <g class="minimap-links"></g>
        <rect class="minimap-viewport" />
      </svg>
    </div>
    <div class="zoom-controls">
      <button class="zoom-btn" id="zoom-in" aria-label="Zoom in">+</button>
      <button class="zoom-btn" id="zoom-out" aria-label="Zoom out">−</button>
      <button class="zoom-btn" id="zoom-reset" aria-label="Reset zoom">↺</button>
    </div>
    <svg id="research-network" width="100%" height="600" viewBox="0 0 800 600">
      <defs>
        <!-- Node patterns -->
        <pattern id="survival-pattern" patternUnits="userSpaceOnUse" width="40" height="40">
          <image href="/assets/icons/survival-analysis.svg" width="40" height="40" />
        </pattern>
        <pattern id="clinical-pattern" patternUnits="userSpaceOnUse" width="40" height="40">
          <image href="/assets/icons/clinical-trials.svg" width="40" height="40" />
        </pattern>
        <pattern id="cardio-pattern" patternUnits="userSpaceOnUse" width="40" height="40">
          <image href="/assets/icons/cardiology.svg" width="40" height="40" />
        </pattern>
        <pattern id="infectious-pattern" patternUnits="userSpaceOnUse" width="40" height="40">
          <image href="/assets/icons/infectious-disease.svg" width="40" height="40" />
        </pattern>
        <pattern id="environmental-pattern" patternUnits="userSpaceOnUse" width="40" height="40">
          <image href="/assets/icons/environmental-health.svg" width="40" height="40" />
        </pattern>
        <pattern id="disparities-pattern" patternUnits="userSpaceOnUse" width="40" height="40">
          <image href="/assets/icons/health-disparities.svg" width="40" height="40" />
        </pattern>
        <pattern id="climate-pattern" patternUnits="userSpaceOnUse" width="40" height="40">
          <image href="/assets/icons/ai.svg" width="40" height="40" />
        </pattern>
        <pattern id="healthcare-pattern" patternUnits="userSpaceOnUse" width="40" height="40">
          <image href="/assets/icons/ai.svg" width="40" height="40" />
        </pattern>
        <pattern id="policy-pattern" patternUnits="userSpaceOnUse" width="40" height="40">
          <image href="/assets/icons/policy.svg" width="40" height="40" />
        </pattern>
        
        <!-- Gradient definitions -->
        <linearGradient id="link-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" style="stop-color:var(--primary-500);stop-opacity:0.6" />
          <stop offset="100%" style="stop-color:var(--secondary-500);stop-opacity:0.6" />
        </linearGradient>
        
        <!-- Cluster gradients -->
        <radialGradient id="cluster-gradient-1" cx="50%" cy="50%" r="50%">
          <stop offset="0%" style="stop-color:var(--primary-500);stop-opacity:0.2" />
          <stop offset="100%" style="stop-color:var(--primary-500);stop-opacity:0" />
        </radialGradient>
        <radialGradient id="cluster-gradient-2" cx="50%" cy="50%" r="50%">
          <stop offset="0%" style="stop-color:var(--secondary-500);stop-opacity:0.2" />
          <stop offset="100%" style="stop-color:var(--secondary-500);stop-opacity:0" />
        </radialGradient>
        <radialGradient id="cluster-gradient-3" cx="50%" cy="50%" r="50%">
          <stop offset="0%" style="stop-color:var(--accent-500);stop-opacity:0.2" />
          <stop offset="100%" style="stop-color:var(--accent-500);stop-opacity:0" />
        </radialGradient>
        
        <!-- Timeline markers -->
        <marker id="timeline-marker" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto">
          <circle cx="5" cy="5" r="3" fill="var(--primary-500)" />
        </marker>
      </defs>
      <!-- Network elements will be dynamically added here -->
    </svg>
    
    <!-- Node expansion panel -->
    <div class="node-expansion" style="display: none;">
      <button class="close-expansion" aria-label="Close details">×</button>
      <div class="expansion-header">
        <h3 class="expansion-title"></h3>
        <span class="expansion-category"></span>
      </div>
      <div class="expansion-content">
        <div class="expansion-description"></div>
        <div class="expansion-metrics">
          <div class="metric-group">
            <h4>Research Output</h4>
            <div class="metric-grid">
              <div class="metric-item">
                <span class="metric-label">Publications</span>
                <span class="metric-value publications"></span>
              </div>
              <div class="metric-item">
                <span class="metric-label">Projects</span>
                <span class="metric-value projects"></span>
              </div>
              <div class="metric-item">
                <span class="metric-label">Citations</span>
                <span class="metric-value citations"></span>
              </div>
            </div>
          </div>
          <div class="metric-group">
            <h4>Collaborations</h4>
            <div class="collaboration-list"></div>
          </div>
          <div class="metric-group">
            <h4>Timeline</h4>
            <div class="timeline-events"></div>
          </div>
        </div>
        <div class="expansion-actions">
          <a href="#" class="action-btn view-publications">View Publications</a>
          <a href="#" class="action-btn view-projects">View Projects</a>
          <a href="#" class="action-btn view-profile">View Profile</a>
        </div>
      </div>
    </div>
  </div>
  
  <div class="network-stats">
    <div class="stat-card">
      <h4>Research Impact</h4>
      <div class="stat-grid">
        <div class="stat-item">
          <span class="stat-label">Total Publications</span>
          <span class="stat-value" id="total-pubs">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Active Projects</span>
          <span class="stat-value" id="active-projs">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Research Areas</span>
          <span class="stat-value" id="research-areas">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Collaborations</span>
          <span class="stat-value" id="collaborations">0</span>
        </div>
      </div>
    </div>
  </div>
  
  <div class="keyboard-shortcuts">
    <button class="shortcuts-btn" aria-label="Keyboard shortcuts">⌨️</button>
    <div class="shortcuts-modal">
      <h3>Keyboard Shortcuts</h3>
      <div class="shortcuts-list">
        <div class="shortcut-item">
          <kbd>Space</kbd>
          <span>Toggle drag mode</span>
        </div>
        <div class="shortcut-item">
          <kbd>+</kbd>
          <span>Zoom in</span>
        </div>
        <div class="shortcut-item">
          <kbd>-</kbd>
          <span>Zoom out</span>
        </div>
        <div class="shortcut-item">
          <kbd>0</kbd>
          <span>Reset zoom</span>
        </div>
        <div class="shortcut-item">
          <kbd>Esc</kbd>
          <span>Clear selection</span>
        </div>
        <div class="shortcut-item">
          <kbd>/</kbd>
          <span>Focus search</span>
        </div>
      </div>
    </div>
  </div>
  
  <div class="network-legend">
    <div class="legend-item">
      <span class="legend-color biostatistics"></span>
      <span class="legend-text">Biostatistics</span>
    </div>
    <div class="legend-item">
      <span class="legend-color epidemiology"></span>
      <span class="legend-text">Epidemiology</span>
    </div>
    <div class="legend-item">
      <span class="legend-color ai"></span>
      <span class="legend-text">AI &amp; Policy</span>
    </div>
  </div>
  
  <!-- Enhanced tooltip -->
  <div id="node-tooltip" class="node-tooltip">
    <div class="tooltip-header">
      <h3 class="tooltip-title"></h3>
      <span class="tooltip-category"></span>
    </div>
    <div class="tooltip-content">
      <p class="tooltip-description"></p>
      <div class="tooltip-metrics">
        <div class="metric">
          <span class="metric-label">Publications</span>
          <span class="metric-value"></span>
        </div>
        <div class="metric">
          <span class="metric-label">Projects</span>
          <span class="metric-value"></span>
        </div>
      </div>
    </div>
    <div class="tooltip-footer">
      <a href="#" class="tooltip-link">Learn More →</a>
    </div>
  </div>
</div>

<style>
.research-network-container {
  background: var(--card-bg);
  border-radius: var(--radius-lg);
  padding: 2rem;
  margin: 2rem 0;
  box-shadow: var(--shadow-lg);
}

.network-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1.5rem;
  flex-wrap: wrap;
  gap: 1rem;
}

.filter-buttons, .view-tabs {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.filter-btn, .view-tab {
  padding: 0.5rem 1rem;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  background: var(--bg-color);
  color: var(--text-color);
  cursor: pointer;
  transition: all 0.3s ease;
}

.filter-btn:hover, .view-tab:hover {
  background: var(--primary-100);
  transform: translateY(-1px);
}

.filter-btn.active, .view-tab.active {
  background: var(--primary-500);
  color: white;
  border-color: var(--primary-500);
}

.network-visualization {
  width: 100%;
  height: 600px;
  background: var(--bg-color);
  border-radius: var(--radius-md);
  overflow: hidden;
  position: relative;
}

.network-legend {
  display: flex;
  justify-content: center;
  gap: 2rem;
  margin-top: 1rem;
  padding: 1rem;
  background: var(--bg-color);
  border-radius: var(--radius-md);
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.legend-color {
  width: 1rem;
  height: 1rem;
  border-radius: 50%;
}

.legend-color.biostatistics { background: var(--primary-500); }
.legend-color.epidemiology { background: var(--secondary-500); }
.legend-color.ai { background: var(--accent-500); }

@media (max-width: 768px) {
  .network-controls {
    flex-direction: column;
    align-items: stretch;
  }
  
  .filter-buttons, .view-tabs {
    justify-content: center;
  }
  
  .network-visualization {
    height: 400px;
  }
}

.node-tooltip {
  position: absolute;
  background: var(--card-bg);
  border-radius: var(--radius-md);
  padding: 1rem;
  box-shadow: var(--shadow-lg);
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.3s ease;
  max-width: 300px;
  z-index: 1000;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border-color);
}

.node-tooltip.visible {
  opacity: 1;
}

.tooltip-header {
  margin-bottom: 0.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.tooltip-title {
  margin: 0;
  font-size: 1.1rem;
  color: var(--heading-color);
}

.tooltip-category {
  font-size: 0.8rem;
  padding: 0.2rem 0.5rem;
  border-radius: var(--radius-sm);
  background: var(--primary-100);
  color: var(--primary-700);
}

.tooltip-content {
  margin-bottom: 0.5rem;
}

.tooltip-description {
  margin: 0 0 0.5rem 0;
  font-size: 0.9rem;
  color: var(--text-color);
  line-height: 1.4;
}

.tooltip-metrics {
  display: flex;
  gap: 1rem;
  margin-top: 0.5rem;
}

.metric {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.metric-label {
  font-size: 0.8rem;
  color: var(--text-muted);
}

.metric-value {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--primary-500);
}

.tooltip-footer {
  margin-top: 0.5rem;
  text-align: right;
}

.tooltip-link {
  font-size: 0.9rem;
  color: var(--primary-500);
  text-decoration: none;
  transition: color 0.2s ease;
}

.tooltip-link:hover {
  color: var(--primary-700);
}

/* Node styles */
.node-icon {
  transition: transform 0.3s ease, filter 0.3s ease;
}

.node-icon:hover {
  transform: scale(1.1);
  filter: brightness(1.2);
}

/* Link styles */
.network-link {
  stroke: url(#link-gradient);
  stroke-width: 2;
  transition: stroke-width 0.3s ease, opacity 0.3s ease;
}

.network-link:hover {
  stroke-width: 3;
}

/* Animation classes */
.fade-enter {
  opacity: 0;
  transform: scale(0.9);
}

.fade-enter-active {
  opacity: 1;
  transform: scale(1);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.fade-exit {
  opacity: 1;
  transform: scale(1);
}

.fade-exit-active {
  opacity: 0;
  transform: scale(0.9);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.search-box {
  position: relative;
  margin-bottom: 1rem;
  width: 100%;
  max-width: 300px;
}

.search-header {
  display: flex;
  gap: 0.5rem;
}

.search-options-btn {
  padding: 0.5rem;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  background: var(--bg-color);
  cursor: pointer;
  transition: all 0.2s ease;
}

.search-options-btn:hover {
  background: var(--primary-100);
}

.search-options {
  display: none;
  padding: 1rem;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  margin-top: 0.5rem;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.search-options.visible {
  display: block;
}

.search-option {
  display: block;
  margin-bottom: 0.5rem;
  cursor: pointer;
}

.search-sort {
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid var(--border-color);
}

.search-sort select {
  margin-left: 0.5rem;
  padding: 0.25rem;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  background: var(--bg-color);
  color: var(--text-color);
}

.search-results {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  margin-top: 0.5rem;
  max-height: 200px;
  overflow-y: auto;
  z-index: 1000;
  display: none;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.search-results.visible {
  display: block;
}

.search-result-item {
  padding: 0.5rem 1rem;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.search-result-item:hover {
  background: var(--primary-100);
}

.search-result-item .result-category {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-left: 0.5rem;
}

.zoom-controls {
  position: absolute;
  top: 1rem;
  right: 1rem;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  z-index: 100;
}

.zoom-btn {
  width: 32px;
  height: 32px;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  background: var(--card-bg);
  color: var(--text-color);
  font-size: 1.2rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.zoom-btn:hover {
  background: var(--primary-100);
  transform: translateY(-1px);
}

.zoom-btn:active {
  transform: translateY(0);
}

@media (max-width: 768px) {
  .network-controls {
    flex-direction: column;
    align-items: stretch;
  }
  
  .search-box {
    max-width: 100%;
  }
  
  .zoom-controls {
    top: auto;
    bottom: 1rem;
    right: 1rem;
    flex-direction: row;
  }
}

.minimap {
  position: absolute;
  bottom: 1rem;
  left: 1rem;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  padding: 0.5rem;
  z-index: 100;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  cursor: move;
}

.minimap-bg {
  fill: var(--bg-color);
  opacity: 0.8;
}

.minimap-nodes circle {
  fill: var(--primary-500);
  opacity: 0.6;
}

.minimap-links line {
  stroke: var(--border-color);
  opacity: 0.4;
}

.minimap-viewport {
  fill: none;
  stroke: var(--primary-500);
  stroke-width: 2;
  stroke-dasharray: 4;
}

.keyboard-shortcuts {
  position: fixed;
  bottom: 1rem;
  right: 1rem;
  z-index: 1000;
}

.shortcuts-btn {
  width: 40px;
  height: 40px;
  border: 1px solid var(--border-color);
  border-radius: 50%;
  background: var(--card-bg);
  cursor: pointer;
  transition: all 0.2s ease;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.shortcuts-btn:hover {
  background: var(--primary-100);
  transform: scale(1.1);
}

.shortcuts-modal {
  display: none;
  position: absolute;
  bottom: 100%;
  right: 0;
  margin-bottom: 1rem;
  padding: 1rem;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  min-width: 250px;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
}

.shortcuts-modal.visible {
  display: block;
}

.shortcuts-modal h3 {
  margin: 0 0 1rem 0;
  font-size: 1.1rem;
  color: var(--heading-color);
}

.shortcuts-list {
  display: grid;
  gap: 0.5rem;
}

.shortcut-item {
  display: flex;
  align-items: center;
  gap: 1rem;
}

kbd {
  padding: 0.2rem 0.4rem;
  background: var(--bg-color);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  font-family: monospace;
  font-size: 0.9rem;
}

@media (max-width: 768px) {
  .minimap {
    display: none;
  }
  
  .keyboard-shortcuts {
    display: none;
  }
}

/* Enhanced contrast and accessibility */
:root {
  --node-stroke: #ffffff;
  --node-stroke-width: 2px;
  --link-opacity: 0.6;
  --text-shadow: 0 1px 2px rgba(0,0,0,0.1);
  --focus-ring: 0 0 0 3px var(--primary-300);
}

/* View tabs */
.view-tabs {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1rem;
  border-bottom: 1px solid var(--border-color);
  padding-bottom: 0.5rem;
}

.view-tab {
  padding: 0.5rem 1rem;
  border: none;
  background: none;
  color: var(--text-muted);
  cursor: pointer;
  position: relative;
  transition: all 0.2s ease;
}

.view-tab:hover {
  color: var(--text-color);
}

.view-tab.active {
  color: var(--primary-500);
  font-weight: 600;
}

.view-tab.active::after {
  content: '';
  position: absolute;
  bottom: -0.5rem;
  left: 0;
  right: 0;
  height: 2px;
  background: var(--primary-500);
}

/* Timeline controls */
.timeline-controls {
  position: absolute;
  top: 1rem;
  left: 50%;
  transform: translateX(-50%);
  background: var(--card-bg);
  padding: 1rem;
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-lg);
  z-index: 100;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border-color);
}

.timeline-slider {
  width: 300px;
  margin-bottom: 0.5rem;
}

.timeline-slider input[type="range"] {
  width: 100%;
  height: 4px;
  background: var(--border-color);
  border-radius: 2px;
  outline: none;
  -webkit-appearance: none;
}

.timeline-slider input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 16px;
  height: 16px;
  background: var(--primary-500);
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid var(--bg-color);
  box-shadow: var(--shadow-sm);
}

.timeline-labels {
  display: flex;
  justify-content: space-between;
  font-size: 0.8rem;
  color: var(--text-muted);
}

.timeline-stats {
  display: flex;
  gap: 1rem;
  margin-top: 0.5rem;
  padding-top: 0.5rem;
  border-top: 1px solid var(--border-color);
}

/* Cluster legend */
.cluster-legend {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: var(--card-bg);
  padding: 1rem;
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-lg);
  z-index: 100;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border-color);
  max-width: 250px;
}

.cluster-legend h4 {
  margin: 0 0 0.5rem 0;
  font-size: 1rem;
  color: var(--heading-color);
}

.cluster-list {
  display: grid;
  gap: 0.5rem;
}

.cluster-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem;
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all 0.2s ease;
}

.cluster-item:hover {
  background: var(--primary-100);
}

.cluster-color {
  width: 12px;
  height: 12px;
  border-radius: 50%;
}

/* Network stats */
.network-stats {
  margin-top: 1rem;
}

.stat-card {
  background: var(--card-bg);
  border-radius: var(--radius-md);
  padding: 1rem;
  box-shadow: var(--shadow-lg);
  border: 1px solid var(--border-color);
}

.stat-card h4 {
  margin: 0 0 1rem 0;
  font-size: 1.1rem;
  color: var(--heading-color);
}

.stat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
}

.stat-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

.stat-label {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-bottom: 0.25rem;
}

.stat-value {
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--primary-500);
}

/* Accessibility improvements */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

@media (prefers-contrast: more) {
  :root {
    --node-stroke-width: 3px;
    --link-opacity: 0.8;
    --text-shadow: none;
  }
  
  .node-icon {
    filter: contrast(1.2);
  }
  
  .stat-value {
    font-weight: 700;
  }
}

/* Focus styles */
button:focus-visible,
input:focus-visible,
select:focus-visible {
  outline: none;
  box-shadow: var(--focus-ring);
}

/* High contrast mode */
@media (forced-colors: active) {
  .node-icon {
    forced-color-adjust: none;
  }
  
  .cluster-color {
    border: 1px solid CanvasText;
  }
  
  .timeline-slider input[type="range"] {
    border: 1px solid CanvasText;
  }
}

/* Node expansion styles */
.node-expansion {
  position: absolute;
  top: 0;
  right: 0;
  width: 400px;
  height: 100%;
  background: var(--card-bg);
  border-left: 1px solid var(--border-color);
  padding: 1.5rem;
  overflow-y: auto;
  z-index: 1000;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  transform: translateX(100%);
  transition: transform 0.3s ease;
}

.node-expansion.visible {
  transform: translateX(0);
}

.close-expansion {
  position: absolute;
  top: 1rem;
  right: 1rem;
  width: 32px;
  height: 32px;
  border: none;
  background: none;
  color: var(--text-muted);
  font-size: 1.5rem;
  cursor: pointer;
  transition: color 0.2s ease;
}

.close-expansion:hover {
  color: var(--text-color);
}

.expansion-header {
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid var(--border-color);
}

.expansion-title {
  margin: 0 0 0.5rem 0;
  font-size: 1.5rem;
  color: var(--heading-color);
}

.expansion-category {
  display: inline-block;
  padding: 0.25rem 0.75rem;
  background: var(--primary-100);
  color: var(--primary-700);
  border-radius: var(--radius-sm);
  font-size: 0.9rem;
}

.expansion-content {
  display: grid;
  gap: 1.5rem;
}

.expansion-description {
  font-size: 1rem;
  line-height: 1.6;
  color: var(--text-color);
}

.metric-group {
  background: var(--bg-color);
  border-radius: var(--radius-md);
  padding: 1rem;
}

.metric-group h4 {
  margin: 0 0 1rem 0;
  font-size: 1.1rem;
  color: var(--heading-color);
}

.metric-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 1rem;
}

.metric-item {
  text-align: center;
}

.metric-item .metric-label {
  display: block;
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-bottom: 0.25rem;
}

.metric-item .metric-value {
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--primary-500);
}

.collaboration-list {
  display: grid;
  gap: 0.75rem;
}

.collaboration-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem;
  background: var(--card-bg);
  border-radius: var(--radius-sm);
  transition: transform 0.2s ease;
}

.collaboration-item:hover {
  transform: translateX(0.5rem);
}

.collaboration-icon {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: var(--primary-100);
  display: flex;
  align-items: center;
  justify-content: center;
}

.collaboration-info {
  flex: 1;
}

.collaboration-name {
  font-weight: 500;
  color: var(--text-color);
}

.collaboration-type {
  font-size: 0.9rem;
  color: var(--text-muted);
}

.timeline-events {
  display: grid;
  gap: 1rem;
}

.timeline-event {
  position: relative;
  padding-left: 1.5rem;
}

.timeline-event::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 2px;
  background: var(--primary-300);
}

.timeline-event::after {
  content: '';
  position: absolute;
  left: -4px;
  top: 0.5rem;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--primary-500);
}

.timeline-event-date {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-bottom: 0.25rem;
}

.timeline-event-title {
  font-weight: 500;
  color: var(--text-color);
  margin-bottom: 0.25rem;
}

.timeline-event-description {
  font-size: 0.9rem;
  color: var(--text-muted);
}

.expansion-actions {
  display: grid;
  gap: 0.75rem;
  margin-top: 1rem;
}

.action-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.75rem;
  background: var(--primary-500);
  color: white;
  text-decoration: none;
  border-radius: var(--radius-md);
  transition: all 0.2s ease;
}

.action-btn:hover {
  background: var(--primary-600);
  transform: translateY(-1px);
}

/* Timeline milestones */
.timeline-milestones {
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid var(--border-color);
}

.timeline-milestones h4 {
  margin: 0 0 0.75rem 0;
  font-size: 1rem;
  color: var(--heading-color);
}

.milestone-list {
  display: grid;
  gap: 0.75rem;
}

.milestone-item {
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  padding: 0.75rem;
  background: var(--bg-color);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all 0.2s ease;
}

.milestone-item:hover {
  background: var(--primary-100);
  transform: translateX(0.5rem);
}

.milestone-year {
  font-weight: 600;
  color: var(--primary-500);
  min-width: 3rem;
}

.milestone-content {
  flex: 1;
}

.milestone-title {
  font-weight: 500;
  color: var(--text-color);
  margin-bottom: 0.25rem;
}

.milestone-description {
  font-size: 0.9rem;
  color: var(--text-muted);
}

@media (max-width: 768px) {
  .node-expansion {
    width: 100%;
    height: 50%;
    top: auto;
    bottom: 0;
    border-left: none;
    border-top: 1px solid var(--border-color);
    transform: translateY(100%);
  }
  
  .node-expansion.visible {
    transform: translateY(0);
  }
  
  .timeline-milestones {
    display: none;
  }
}

/* Advanced controls */
.advanced-controls {
  display: flex;
  gap: 0.5rem;
  margin-left: auto;
}

.control-btn {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md);
  color: var(--text-color);
  cursor: pointer;
  transition: all 0.2s ease;
}

.control-btn:hover {
  background: var(--primary-100);
  transform: translateY(-1px);
}

.btn-icon {
  font-size: 1.2rem;
}

/* Filter panel */
.filter-panel {
  position: absolute;
  top: 0;
  right: 0;
  width: 300px;
  height: 100%;
  background: var(--card-bg);
  border-left: 1px solid var(--border-color);
  z-index: 1000;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  transform: translateX(100%);
  transition: transform 0.3s ease;
}

.filter-panel.visible {
  transform: translateX(0);
}

.filter-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  border-bottom: 1px solid var(--border-color);
}

.filter-header h3 {
  margin: 0;
  font-size: 1.1rem;
  color: var(--heading-color);
}

.close-filter {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 1.5rem;
  cursor: pointer;
  transition: color 0.2s ease;
}

.close-filter:hover {
  color: var(--text-color);
}

.filter-content {
  padding: 1rem;
  overflow-y: auto;
  height: calc(100% - 60px);
}

.filter-section {
  margin-bottom: 1.5rem;
}

.filter-section h4 {
  margin: 0 0 0.75rem 0;
  font-size: 1rem;
  color: var(--heading-color);
}

.range-slider {
  width: 100%;
}

.range-labels {
  display: flex;
  justify-content: space-between;
  margin-top: 0.5rem;
  font-size: 0.9rem;
  color: var(--text-muted);
}

.impact-filters {
  display: grid;
  gap: 0.5rem;
}

.filter-checkbox {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
}

.range-inputs {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.range-inputs input {
  width: 80px;
  padding: 0.25rem;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  background: var(--bg-color);
  color: var(--text-color);
}

.strength-slider {
  width: 100%;
}

.strength-labels {
  display: flex;
  justify-content: space-between;
  margin-top: 0.5rem;
  font-size: 0.9rem;
  color: var(--text-muted);
}

.filter-actions {
  display: flex;
  gap: 0.5rem;
  margin-top: 1.5rem;
}

.filter-actions button {
  flex: 1;
  padding: 0.75rem;
  border: none;
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-reset {
  background: var(--bg-color);
  color: var(--text-color);
}

.filter-apply {
  background: var(--primary-500);
  color: white;
}

.filter-reset:hover {
  background: var(--border-color);
}

.filter-apply:hover {
  background: var(--primary-600);
}

/* Export panel */
.export-panel {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 400px;
  background: var(--card-bg);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  z-index: 1000;
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
}

.export-panel.visible {
  opacity: 1;
  visibility: visible;
}

.export-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  border-bottom: 1px solid var(--border-color);
}

.export-header h3 {
  margin: 0;
  font-size: 1.1rem;
  color: var(--heading-color);
}

.close-export {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 1.5rem;
  cursor: pointer;
  transition: color 0.2s ease;
}

.close-export:hover {
  color: var(--text-color);
}

.export-content {
  padding: 1rem;
}

.export-section {
  margin-bottom: 1.5rem;
}

.export-section h4 {
  margin: 0 0 0.75rem 0;
  font-size: 1rem;
  color: var(--heading-color);
}

.export-format, .export-options, .export-visual {
  display: grid;
  gap: 0.75rem;
}

.format-option, .export-checkbox {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
}

.export-actions {
  display: flex;
  gap: 0.5rem;
  margin-top: 1.5rem;
}

.export-actions button {
  flex: 1;
  padding: 0.75rem;
  border: none;
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all 0.2s ease;
}

.export-cancel {
  background: var(--bg-color);
  color: var(--text-color);
}

.export-download {
  background: var(--primary-500);
  color: white;
}

.export-cancel:hover {
  background: var(--border-color);
}

.export-download:hover {
  background: var(--primary-600);
}

@media (max-width: 768px) {
  .advanced-controls {
    margin-left: 0;
    margin-top: 1rem;
  }
  
  .filter-panel {
    width: 100%;
    height: 50%;
    top: auto;
    bottom: 0;
    border-left: none;
    border-top: 1px solid var(--border-color);
    transform: translateY(100%);
  }
  
  .filter-panel.visible {
    transform: translateY(0);
  }
  
  .export-panel {
    width: 90%;
    max-width: 400px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Enhanced research data structure with timeline and cluster information
  const researchData = {
    nodes: [
      // Biostatistics
      { 
        id: 'survival', 
        group: 'biostatistics', 
        label: 'Survival Analysis',
        description: 'Time-to-event data analysis and competing risks',
        publications: 12,
        projects: 5,
        icon: 'survival-pattern',
        link: '/biostatistics#survival-analysis',
        year: 2018,
        cluster: 'biostatistics',
        impact: 0.8,
        collaborators: ['clinical', 'cardio'],
        citations: 156,
        timeline: [
          { year: 2018, title: 'Started Research', description: 'Initiated survival analysis research' },
          { year: 2019, title: 'First Publication', description: 'Published first paper on competing risks' },
          { year: 2020, title: 'Methodology Award', description: 'Received award for innovative methodology' }
        ],
        collaborators: [
          { id: 'clinical', name: 'Clinical Trials', type: 'Methodology Development' },
          { id: 'cardio', name: 'Cardiology Research', type: 'Applied Research' }
        ]
      },
      { 
        id: 'clinical', 
        group: 'biostatistics', 
        label: 'Clinical Trials',
        description: 'Design and analysis of clinical studies',
        publications: 8,
        projects: 4,
        icon: 'clinical-pattern',
        link: '/biostatistics#clinical-trials',
        year: 2018,
        cluster: 'biostatistics',
        impact: 0.8,
        collaborators: ['survival', 'cardio']
      },
      { 
        id: 'cardio', 
        group: 'biostatistics', 
        label: 'Cardiology Research',
        description: 'Statistical modeling of cardiovascular outcomes',
        publications: 10,
        projects: 6,
        icon: 'cardio-pattern',
        link: '/biostatistics#cardiology',
        year: 2018,
        cluster: 'biostatistics',
        impact: 0.8,
        collaborators: ['survival', 'clinical']
      },
      
      // Epidemiology
      { 
        id: 'infectious', 
        group: 'epidemiology', 
        label: 'Infectious Disease',
        description: 'Disease transmission and outbreak analysis',
        publications: 15,
        projects: 7,
        icon: 'infectious-pattern',
        link: '/epidemiology#infectious-disease',
        year: 2018,
        cluster: 'epidemiology',
        impact: 0.8,
        collaborators: ['environmental', 'disparities']
      },
      { 
        id: 'environmental', 
        group: 'epidemiology', 
        label: 'Environmental Health',
        description: 'Health impacts of environmental factors',
        publications: 9,
        projects: 4,
        icon: 'environmental-pattern',
        link: '/epidemiology#environmental-health',
        year: 2018,
        cluster: 'epidemiology',
        impact: 0.8,
        collaborators: ['infectious', 'disparities']
      },
      { 
        id: 'disparities', 
        group: 'epidemiology', 
        label: 'Health Disparities',
        description: 'Social determinants of health',
        publications: 11,
        projects: 5,
        icon: 'disparities-pattern',
        link: '/epidemiology#health-disparities',
        year: 2018,
        cluster: 'epidemiology',
        impact: 0.8,
        collaborators: ['infectious', 'environmental']
      },
      
      // AI & Policy
      { 
        id: 'climate', 
        group: 'ai', 
        label: 'Climate AI',
        description: 'AI applications in climate science',
        publications: 7,
        projects: 3,
        icon: 'climate-pattern',
        link: '/ai-projects#climate-modeling',
        year: 2018,
        cluster: 'ai',
        impact: 0.8,
        collaborators: ['healthcare', 'policy']
      },
      { 
        id: 'healthcare', 
        group: 'ai', 
        label: 'Healthcare AI',
        description: 'Machine learning in healthcare',
        publications: 9,
        projects: 4,
        icon: 'healthcare-pattern',
        link: '/ai-projects#healthcare-ai',
        year: 2018,
        cluster: 'ai',
        impact: 0.8,
        collaborators: ['climate', 'policy']
      },
      { 
        id: 'policy', 
        group: 'ai', 
        label: 'AI Policy',
        description: 'Governance and ethical frameworks',
        publications: 6,
        projects: 3,
        icon: 'policy-pattern',
        link: '/ai-projects#ai-policy',
        year: 2018,
        cluster: 'ai',
        impact: 0.8,
        collaborators: ['climate', 'healthcare']
      }
    ],
    links: [
      // Cross-domain connections
      { source: 'survival', target: 'clinical', strength: 0.8, year: 2019, type: 'collaboration' },
      { source: 'clinical', target: 'cardio', strength: 0.7, year: 2019, type: 'collaboration' },
      { source: 'infectious', target: 'environmental', strength: 0.6, year: 2019, type: 'collaboration' },
      { source: 'environmental', target: 'disparities', strength: 0.5, year: 2019, type: 'collaboration' },
      { source: 'climate', target: 'healthcare', strength: 0.4, year: 2019, type: 'collaboration' },
      { source: 'healthcare', target: 'policy', strength: 0.7, year: 2019, type: 'collaboration' },
      
      // Inter-domain connections
      { source: 'survival', target: 'infectious', strength: 0.5, year: 2019, type: 'collaboration' },
      { source: 'clinical', target: 'healthcare', strength: 0.8, year: 2019, type: 'collaboration' },
      { source: 'disparities', target: 'policy', strength: 0.6, year: 2019, type: 'collaboration' }
    ],
    clusters: [
      {
        id: 'biostatistics',
        name: 'Biostatistics Research',
        color: 'var(--primary-500)',
        description: 'Statistical methods and clinical trials',
        nodes: ['survival', 'clinical', 'cardio']
      },
      {
        id: 'epidemiology',
        name: 'Epidemiology Studies',
        color: 'var(--secondary-500)',
        description: 'Disease patterns and public health',
        nodes: ['infectious', 'environmental', 'disparities']
      },
      {
        id: 'ai',
        name: 'AI & Policy Research',
        color: 'var(--accent-500)',
        description: 'Machine learning and healthcare policy',
        nodes: ['climate', 'healthcare', 'policy']
      }
    ],
    timeline: {
      start: 2018,
      end: 2024,
      milestones: [
        {
          year: 2019,
          title: 'Clinical Trials Research',
          description: 'Established new methodology for adaptive trial design',
          impact: 'high',
          areas: ['biostatistics', 'clinical']
        },
        {
          year: 2020,
          title: 'AI Healthcare Projects',
          description: 'Launched machine learning initiatives in healthcare',
          impact: 'high',
          areas: ['ai', 'healthcare']
        },
        {
          year: 2021,
          title: 'Health Disparities Study',
          description: 'Initiated large-scale health disparities research',
          impact: 'medium',
          areas: ['epidemiology', 'disparities']
        },
        {
          year: 2022,
          title: 'Climate Research Expansion',
          description: 'Expanded research into climate-health interactions',
          impact: 'high',
          areas: ['climate', 'environmental']
        },
        {
          year: 2023,
          title: 'Policy Framework Development',
          description: 'Developed AI governance framework for healthcare',
          impact: 'medium',
          areas: ['policy', 'ai']
        }
      ]
    }
  };

  // Initialize the visualization with enhanced features
  initNetworkVisualization(researchData);
});

function initNetworkVisualization(data) {
  const svg = d3.select('#research-network');
  const width = svg.node().getBoundingClientRect().width;
  const height = 600;
  const tooltip = d3.select('#node-tooltip');
  
  // Clear any existing content
  svg.selectAll('*').remove();
  
  // Create a group for the network with zoom behavior
  const g = svg.append('g')
    .attr('transform', `translate(${width/2},${height/2})`);
  
  // Add zoom behavior
  const zoom = d3.zoom()
    .scaleExtent([0.5, 3])
    .on('zoom', (event) => {
      g.attr('transform', event.transform);
    });
  
  svg.call(zoom);
  
  // Zoom controls
  document.getElementById('zoom-in').addEventListener('click', () => {
    svg.transition()
      .duration(300)
      .call(zoom.scaleBy, 1.3);
  });
  
  document.getElementById('zoom-out').addEventListener('click', () => {
    svg.transition()
      .duration(300)
      .call(zoom.scaleBy, 0.7);
  });
  
  document.getElementById('zoom-reset').addEventListener('click', () => {
    svg.transition()
      .duration(300)
      .call(zoom.transform, d3.zoomIdentity);
  });
  
  // Initialize minimap
  const minimap = d3.select('#network-minimap svg');
  const minimapNodes = minimap.select('.minimap-nodes');
  const minimapLinks = minimap.select('.minimap-links');
  const minimapViewport = minimap.select('.minimap-viewport');
  
  // Create the force simulation
  const simulation = d3.forceSimulation(data.nodes)
    .force('link', d3.forceLink(data.links).id(d => d.id).distance(120))
    .force('charge', d3.forceManyBody().strength(-400))
    .force('center', d3.forceCenter(0, 0))
    .force('collision', d3.forceCollide().radius(60));
  
  // Create the links with gradient
  const link = g.append('g')
    .selectAll('line')
    .data(data.links)
    .enter().append('line')
    .attr('class', 'network-link')
    .attr('stroke', 'url(#link-gradient)')
    .attr('stroke-opacity', 0.6)
    .attr('stroke-width', d => Math.sqrt(d.strength) * 2);
  
  // Create the nodes
  const node = g.append('g')
    .selectAll('g')
    .data(data.nodes)
    .enter().append('g')
    .attr('class', 'node')
    .attr('data-id', d => d.id)
    .call(d3.drag()
      .on('start', dragstarted)
      .on('drag', dragged)
      .on('end', dragended));
  
  // Add custom icons to nodes
  node.append('circle')
    .attr('r', 25)
    .attr('fill', d => `url(#${d.icon})`)
    .attr('stroke', '#fff')
    .attr('stroke-width', 2)
    .attr('class', 'node-icon');
  
  // Add labels to nodes
  node.append('text')
    .text(d => d.label)
    .attr('text-anchor', 'middle')
    .attr('dy', 35)
    .attr('fill', 'var(--text-color)')
    .style('font-size', '12px')
    .style('pointer-events', 'none');
  
  // Add tooltip interactions
  node.on('mouseover', function(event, d) {
    tooltip
      .classed('visible', true)
      .html(`
        <div class="tooltip-header">
          <h3 class="tooltip-title">${d.label}</h3>
          <span class="tooltip-category">${d.group}</span>
        </div>
        <div class="tooltip-content">
          <p class="tooltip-description">${d.description}</p>
          <div class="tooltip-metrics">
            <div class="metric">
              <span class="metric-label">Publications</span>
              <span class="metric-value">${d.publications}</span>
            </div>
            <div class="metric">
              <span class="metric-label">Projects</span>
              <span class="metric-value">${d.projects}</span>
            </div>
          </div>
        </div>
        <div class="tooltip-footer">
          <a href="${d.link}" class="tooltip-link">Learn More →</a>
        </div>
      `)
      .style('left', (event.pageX + 10) + 'px')
      .style('top', (event.pageY - 10) + 'px');
    
    // Highlight connected nodes and links
    link.style('stroke-width', l => 
      l.source === d || l.target === d ? 4 : 2
    );
    
    node.style('opacity', n => 
      n === d || data.links.some(l => 
        (l.source === d && l.target === n) || 
        (l.source === n && l.target === d)
      ) ? 1 : 0.2
    );
  })
  .on('mouseout', function() {
    tooltip.classed('visible', false);
    link.style('stroke-width', d => Math.sqrt(d.strength) * 2);
    node.style('opacity', 1);
  })
  .on('mousemove', function(event) {
    tooltip
      .style('left', (event.pageX + 10) + 'px')
      .style('top', (event.pageY - 10) + 'px');
  });
  
  // Update positions on each tick
  simulation.on('tick', () => {
    link
      .attr('x1', d => d.source.x)
      .attr('y1', d => d.source.y)
      .attr('x2', d => d.target.x)
      .attr('y2', d => d.target.y);
    
    node.attr('transform', d => `translate(${d.x},${d.y})`);
    
    // Update minimap
    minimapNodes.selectAll('circle')
      .data(data.nodes)
      .join('circle')
      .attr('cx', d => d.x * 0.1875) // Scale to minimap size
      .attr('cy', d => d.y * 0.25)
      .attr('r', 2);
    
    minimapLinks.selectAll('line')
      .data(data.links)
      .join('line')
      .attr('x1', d => d.source.x * 0.1875)
      .attr('y1', d => d.source.y * 0.25)
      .attr('x2', d => d.target.x * 0.1875)
      .attr('y2', d => d.target.y * 0.25);
    
    // Update viewport rectangle
    const transform = d3.zoomTransform(svg.node());
    minimapViewport
      .attr('x', -transform.x * 0.1875)
      .attr('y', -transform.y * 0.25)
      .attr('width', width * transform.k * 0.1875)
      .attr('height', height * transform.k * 0.25);
  });
  
  // Drag functions
  function dragstarted(event, d) {
    if (!event.active) simulation.alphaTarget(0.3).restart();
    d.fx = d.x;
    d.fy = d.y;
  }
  
  function dragged(event, d) {
    d.fx = event.x;
    d.fy = event.y;
  }
  
  function dragended(event, d) {
    if (!event.active) simulation.alphaTarget(0);
    d.fx = null;
    d.fy = null;
  }
  
  // Handle filter buttons
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const filter = this.dataset.filter;
      
      // Update active button
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      this.classList.add('active');
      
      // Filter nodes and links
      node.style('opacity', d => filter === 'all' || d.group === filter ? 1 : 0.2);
      link.style('opacity', d => 
        filter === 'all' || 
        d.source.group === filter || 
        d.target.group === filter ? 0.6 : 0.1
      );
    });
  });
  
  // Initialize view tabs
  const viewTabs = document.querySelectorAll('.view-tab');
  viewTabs.forEach(tab => {
    tab.addEventListener('click', () => {
      const view = tab.dataset.view;
      
      // Update active tab
      viewTabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      
      // Show/hide relevant controls
      document.querySelector('.timeline-controls').style.display = 
        view === 'timeline' ? 'block' : 'none';
      document.querySelector('.cluster-legend').style.display = 
        view === 'clusters' ? 'block' : 'none';
      
      // Update visualization
      updateVisualization(view);
    });
  });
  
  // Initialize timeline
  const timelineSlider = document.getElementById('timeline-slider');
  timelineSlider.addEventListener('input', (event) => {
    const year = parseInt(event.target.value);
    updateTimeline(year);
  });
  
  // Initialize cluster legend
  const clusterLegend = document.querySelector('.cluster-list');
  data.clusters.forEach(cluster => {
    const item = document.createElement('div');
    item.className = 'cluster-item';
    item.innerHTML = `
      <span class="cluster-color" style="background: ${cluster.color}"></span>
      <span class="cluster-name">${cluster.name}</span>
    `;
    item.addEventListener('click', () => highlightCluster(cluster));
    clusterLegend.appendChild(item);
  });
  
  // Update network statistics
  function updateStats() {
    const stats = {
      publications: data.nodes.reduce((sum, node) => sum + node.publications, 0),
      projects: data.nodes.reduce((sum, node) => sum + node.projects, 0),
      areas: data.clusters.length,
      collaborations: data.links.filter(l => l.type === 'collaboration').length
    };
    
    document.getElementById('total-pubs').textContent = stats.publications;
    document.getElementById('active-projs').textContent = stats.projects;
    document.getElementById('research-areas').textContent = stats.areas;
    document.getElementById('collaborations').textContent = stats.collaborations;
  }
  
  // Update visualization based on current view
  function updateVisualization(view) {
    switch(view) {
      case 'network':
        // Reset to force-directed layout
        simulation.force('cluster', null);
        data.nodes.forEach(d => {
          d.fx = null;
          d.fy = null;
        });
        break;
        
      case 'timeline':
        // Arrange nodes by year
        const yearScale = d3.scaleLinear()
          .domain([data.timeline.start, data.timeline.end])
          .range([-width/3, width/3]);
        
        data.nodes.forEach(d => {
          d.fx = yearScale(d.year);
          d.fy = (Math.random() - 0.5) * height/2;
        });
        break;
        
      case 'clusters':
        // Arrange nodes in clusters
        const clusterScale = d3.scaleOrdinal()
          .domain(data.clusters.map(c => c.id))
          .range([-width/3, 0, width/3]);
        
        data.nodes.forEach(d => {
          const cluster = data.clusters.find(c => c.nodes.includes(d.id));
          d.fx = clusterScale(cluster.id);
          d.fy = (Math.random() - 0.5) * height/2;
        });
        
        // Add cluster force
        simulation.force('cluster', d3.forceCluster()
          .centers(d => clusterScale(d.cluster))
          .strength(0.5));
        break;
    }
    
    simulation.alpha(0.3).restart();
  }
  
  // Update timeline view
  function updateTimeline(year) {
    // Update node visibility
    node.style('opacity', d => d.year <= year ? 1 : 0.2);
    link.style('opacity', d => d.year <= year ? 0.6 : 0.1);
    
    // Update statistics
    const activeNodes = data.nodes.filter(d => d.year <= year);
    document.getElementById('active-projects').textContent = 
      activeNodes.reduce((sum, d) => sum + d.projects, 0);
    document.getElementById('total-publications').textContent = 
      activeNodes.reduce((sum, d) => sum + d.publications, 0);
    
    // Add timeline marker
    const marker = svg.select('.timeline-marker');
    if (marker.empty()) {
      svg.append('line')
        .attr('class', 'timeline-marker')
        .attr('y1', -height/2)
        .attr('y2', height/2)
        .attr('marker-end', 'url(#timeline-marker)');
    }
    
    const yearScale = d3.scaleLinear()
      .domain([data.timeline.start, data.timeline.end])
      .range([-width/3, width/3]);
    
    marker
      .attr('x1', yearScale(year))
      .attr('x2', yearScale(year));
  }
  
  // Highlight cluster
  function highlightCluster(cluster) {
    // Reset all nodes
    node.style('opacity', 1);
    link.style('opacity', 0.6);
    
    // Highlight cluster nodes and their connections
    node.style('opacity', d => 
      cluster.nodes.includes(d.id) ? 1 : 0.2
    );
    
    link.style('opacity', d => 
      cluster.nodes.includes(d.source.id) && cluster.nodes.includes(d.target.id) ? 0.8 : 0.1
    );
    
    // Add cluster background
    const clusterGroup = svg.select('.cluster-background');
    if (clusterGroup.empty()) {
      svg.append('g')
        .attr('class', 'cluster-background');
    }
    
    clusterGroup.selectAll('circle')
      .data([cluster])
      .join('circle')
      .attr('fill', `url(#cluster-gradient-${data.clusters.indexOf(cluster) + 1})`)
      .attr('r', 100)
      .attr('cx', d => d3.mean(cluster.nodes.map(id => 
        data.nodes.find(n => n.id === id).x
      )))
      .attr('cy', d => d3.mean(cluster.nodes.map(id => 
        data.nodes.find(n => n.id === id).y
      )));
  }
  
  // Initialize stats
  updateStats();
  
  // Enhanced search functionality
  const searchInput = document.getElementById('node-search');
  const searchResults = document.getElementById('search-results');
  const searchOptions = document.querySelector('.search-options');
  const searchOptionsBtn = document.querySelector('.search-options-btn');
  const searchSort = document.getElementById('search-sort');
  
  // Toggle search options
  searchOptionsBtn.addEventListener('click', () => {
    searchOptions.classList.toggle('visible');
  });
  
  // Close search options when clicking outside
  document.addEventListener('click', (event) => {
    if (!searchOptionsBtn.contains(event.target) && !searchOptions.contains(event.target)) {
      searchOptions.classList.remove('visible');
    }
  });
  
  // Enhanced search function
  function performSearch(query) {
    if (query.length < 2) {
      searchResults.classList.remove('visible');
      return;
    }
    
    const activeFilters = Array.from(searchOptions.querySelectorAll('input[type="checkbox"]:checked'))
      .map(cb => cb.dataset.filter);
    
    const matches = data.nodes.filter(node => {
      return activeFilters.some(filter => {
        switch(filter) {
          case 'label': return node.label.toLowerCase().includes(query);
          case 'description': return node.description.toLowerCase().includes(query);
          case 'category': return node.group.toLowerCase().includes(query);
          default: return false;
        }
      });
    });
    
    // Sort results
    const sortBy = searchSort.value;
    matches.sort((a, b) => {
      switch(sortBy) {
        case 'publications': return b.publications - a.publications;
        case 'projects': return b.projects - a.projects;
        default: return 0; // relevance (original order)
      }
    });
    
    if (matches.length > 0) {
      searchResults.innerHTML = matches.map(node => `
        <div class="search-result-item" data-id="${node.id}">
          <div class="result-title">${node.label}</div>
          <div class="result-details">
            <span class="result-category">${node.group}</span>
            <span class="result-metrics">
              ${node.publications} publications · ${node.projects} projects
            </span>
          </div>
        </div>
      `).join('');
      
      searchResults.classList.add('visible');
      
      // Add click handlers to search results
      searchResults.querySelectorAll('.search-result-item').forEach(item => {
        item.addEventListener('click', () => {
          const nodeId = item.dataset.id;
          const node = data.nodes.find(n => n.id === nodeId);
          
          // Center and highlight the selected node
          const nodeElement = d3.select(`.node[data-id="${nodeId}"]`);
          const transform = d3.zoomTransform(svg.node());
          
          svg.transition()
            .duration(750)
            .call(zoom.transform, d3.zoomIdentity
              .translate(width/2, height/2)
              .scale(1.5)
              .translate(-node.x, -node.y)
            );
          
          // Highlight the node
          nodeElement.dispatch('mouseover');
          
          // Clear search
          searchInput.value = '';
          searchResults.classList.remove('visible');
        });
      });
    } else {
      searchResults.innerHTML = '<div class="search-result-item">No matches found</div>';
      searchResults.classList.add('visible');
    }
  }
  
  // Debounced search
  let searchTimeout;
  searchInput.addEventListener('input', function() {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(() => performSearch(this.value.toLowerCase()), 300);
  });
  
  // Keyboard shortcuts
  const shortcutsBtn = document.querySelector('.shortcuts-btn');
  const shortcutsModal = document.querySelector('.shortcuts-modal');
  
  shortcutsBtn.addEventListener('click', () => {
    shortcutsModal.classList.toggle('visible');
  });
  
  document.addEventListener('keydown', (event) => {
    // Toggle shortcuts modal
    if (event.key === '?' && !event.ctrlKey && !event.metaKey) {
      event.preventDefault();
      shortcutsModal.classList.toggle('visible');
    }
    
    // Focus search
    if (event.key === '/' && !event.ctrlKey && !event.metaKey) {
      event.preventDefault();
      searchInput.focus();
    }
    
    // Zoom controls
    if (event.key === '+' || event.key === '=') {
      event.preventDefault();
      svg.transition().duration(300).call(zoom.scaleBy, 1.3);
    }
    if (event.key === '-') {
      event.preventDefault();
      svg.transition().duration(300).call(zoom.scaleBy, 0.7);
    }
    if (event.key === '0') {
      event.preventDefault();
      svg.transition().duration(300).call(zoom.transform, d3.zoomIdentity);
    }
    
    // Clear selection
    if (event.key === 'Escape') {
      event.preventDefault();
      searchInput.value = '';
      searchResults.classList.remove('visible');
      searchOptions.classList.remove('visible');
      shortcutsModal.classList.remove('visible');
      // Reset node highlighting
      node.style('opacity', 1);
      link.style('stroke-width', d => Math.sqrt(d.strength) * 2);
    }
  });
  
  // Close shortcuts modal when clicking outside
  document.addEventListener('click', (event) => {
    if (!shortcutsBtn.contains(event.target) && !shortcutsModal.contains(event.target)) {
      shortcutsModal.classList.remove('visible');
    }
  });
  
  // Initialize node expansion
  const expansionPanel = document.querySelector('.node-expansion');
  const closeExpansion = document.querySelector('.close-expansion');
  
  closeExpansion.addEventListener('click', () => {
    expansionPanel.classList.remove('visible');
  });
  
  // Enhanced node click handler
  node.on('click', function(event, d) {
    event.stopPropagation();
    
    // Update expansion panel content
    expansionPanel.querySelector('.expansion-title').textContent = d.label;
    expansionPanel.querySelector('.expansion-category').textContent = d.group;
    expansionPanel.querySelector('.expansion-description').textContent = d.description;
    
    // Update metrics
    expansionPanel.querySelector('.metric-value.publications').textContent = d.publications;
    expansionPanel.querySelector('.metric-value.projects').textContent = d.projects;
    expansionPanel.querySelector('.metric-value.citations').textContent = d.citations;
    
    // Update collaborations
    const collaborationList = expansionPanel.querySelector('.collaboration-list');
    collaborationList.innerHTML = d.collaborators.map(collab => {
      const collaborator = data.nodes.find(n => n.id === collab.id);
      return `
        <div class="collaboration-item">
          <div class="collaboration-icon">
            <img src="/assets/icons/${collaborator.icon.replace('-pattern', '')}.svg" alt="" width="20" height="20">
          </div>
          <div class="collaboration-info">
            <div class="collaboration-name">${collaborator.label}</div>
            <div class="collaboration-type">${collab.type}</div>
          </div>
        </div>
      `;
    }).join('');
    
    // Update timeline events
    const timelineEvents = expansionPanel.querySelector('.timeline-events');
    timelineEvents.innerHTML = d.timeline.map(event => `
      <div class="timeline-event">
        <div class="timeline-event-date">${event.year}</div>
        <div class="timeline-event-title">${event.title}</div>
        <div class="timeline-event-description">${event.description}</div>
      </div>
    `).join('');
    
    // Update action buttons
    const actionBtns = expansionPanel.querySelectorAll('.action-btn');
    actionBtns[0].href = `${d.link}#publications`;
    actionBtns[1].href = `${d.link}#projects`;
    actionBtns[2].href = d.link;
    
    // Show expansion panel
    expansionPanel.classList.add('visible');
    
    // Center the node
    const transform = d3.zoomTransform(svg.node());
    svg.transition()
      .duration(750)
      .call(zoom.transform, d3.zoomIdentity
        .translate(width/2, height/2)
        .scale(1.5)
        .translate(-d.x, -d.y)
      );
  });
  
  // Initialize timeline milestones
  const milestoneList = document.querySelector('.milestone-list');
  data.timeline.milestones.forEach(milestone => {
    const item = document.createElement('div');
    item.className = 'milestone-item';
    item.innerHTML = `
      <span class="milestone-year">${milestone.year}</span>
      <div class="milestone-content">
        <div class="milestone-title">${milestone.title}</div>
        <div class="milestone-description">${milestone.description}</div>
      </div>
    `;
    
    item.addEventListener('click', () => {
      // Update timeline slider
      timelineSlider.value = milestone.year;
      updateTimeline(milestone.year);
      
      // Highlight relevant nodes
      const relevantNodes = data.nodes.filter(node => 
        milestone.areas.includes(node.group)
      );
      
      node.style('opacity', n => 
        relevantNodes.includes(n) ? 1 : 0.2
      );
      
      link.style('opacity', l => 
        relevantNodes.includes(l.source) && relevantNodes.includes(l.target) ? 0.8 : 0.1
      );
    });
    
    milestoneList.appendChild(item);
  });
  
  // Close expansion panel when clicking outside
  document.addEventListener('click', (event) => {
    if (!expansionPanel.contains(event.target) && 
        !event.target.closest('.node')) {
      expansionPanel.classList.remove('visible');
    }
  });
  
  // Initialize advanced controls
  const filterBtn = document.getElementById('filter-btn');
  const exportBtn = document.getElementById('export-btn');
  const filterPanel = document.querySelector('.filter-panel');
  const exportPanel = document.querySelector('.export-panel');
  
  // Filter panel controls
  filterBtn.addEventListener('click', () => {
    filterPanel.classList.toggle('visible');
    exportPanel.classList.remove('visible');
  });
  
  document.querySelector('.close-filter').addEventListener('click', () => {
    filterPanel.classList.remove('visible');
  });
  
  // Export panel controls
  exportBtn.addEventListener('click', () => {
    exportPanel.classList.toggle('visible');
    filterPanel.classList.remove('visible');
  });
  
  document.querySelector('.close-export').addEventListener('click', () => {
    exportPanel.classList.remove('visible');
  });
  
  // Advanced filtering
  const yearRange = document.getElementById('year-range');
  const yearValue = document.getElementById('year-value');
  const minPubs = document.getElementById('min-pubs');
  const maxPubs = document.getElementById('max-pubs');
  const collabStrength = document.getElementById('collab-strength');
  
  yearRange.addEventListener('input', (e) => {
    yearValue.textContent = e.target.value;
  });
  
  document.querySelector('.filter-apply').addEventListener('click', () => {
    const filters = {
      year: parseInt(yearRange.value),
      impact: Array.from(document.querySelectorAll('.impact-filters input:checked'))
        .map(input => input.value),
      publications: {
        min: parseInt(minPubs.value) || 0,
        max: parseInt(maxPubs.value) || Infinity
      },
      collaborationStrength: parseInt(collabStrength.value) / 100
    };
    
    applyFilters(filters);
    filterPanel.classList.remove('visible');
  });
  
  document.querySelector('.filter-reset').addEventListener('click', () => {
    yearRange.value = 2024;
    yearValue.textContent = '2024';
    document.querySelectorAll('.impact-filters input').forEach(input => {
      input.checked = true;
    });
    minPubs.value = '';
    maxPubs.value = '';
    collabStrength.value = 0;
    
    // Reset visualization
    node.style('opacity', 1);
    link.style('opacity', 0.6);
    updateTimeline(2024);
  });
  
  function applyFilters(filters) {
    node.style('opacity', d => {
      const yearMatch = d.year <= filters.year;
      const impactMatch = filters.impact.includes(d.impact);
      const pubMatch = d.publications >= filters.publications.min && 
                      d.publications <= filters.publications.max;
      
      return yearMatch && impactMatch && pubMatch ? 1 : 0.2;
    });
    
    link.style('opacity', d => {
      const sourceNode = data.nodes.find(n => n.id === d.source.id);
      const targetNode = data.nodes.find(n => n.id === d.target.id);
      const strengthMatch = d.strength >= filters.collaborationStrength;
      
      return (sourceNode.year <= filters.year && 
              targetNode.year <= filters.year && 
              strengthMatch) ? 0.6 : 0.1;
    });
    
    updateTimeline(filters.year);
  }
  
  // Export functionality
  document.querySelector('.export-download').addEventListener('click', () => {
    const format = document.querySelector('input[name="format"]:checked').value;
    const options = Array.from(document.querySelectorAll('.export-options input:checked'))
      .map(input => input.value);
    const visual = Array.from(document.querySelectorAll('.export-visual input:checked'))
      .map(input => input.value);
    
    const exportData = prepareExportData(format, options, visual);
    downloadExport(exportData, format);
    exportPanel.classList.remove('visible');
  });
  
  function prepareExportData(format, options, visual) {
    const exportObj = {};
    
    if (options.includes('nodes')) {
      exportObj.nodes = data.nodes.map(node => ({
        id: node.id,
        label: node.label,
        group: node.group,
        publications: node.publications,
        projects: node.projects,
        citations: node.citations,
        year: node.year,
        impact: node.impact
      }));
    }
    
    if (options.includes('links')) {
      exportObj.links = data.links.map(link => ({
        source: link.source.id,
        target: link.target.id,
        strength: link.strength,
        type: link.type,
        year: link.year
      }));
    }
    
    if (options.includes('timeline')) {
      exportObj.timeline = data.timeline;
    }
    
    if (options.includes('metrics')) {
      exportObj.metrics = {
        totalPublications: data.nodes.reduce((sum, node) => sum + node.publications, 0),
        totalProjects: data.nodes.reduce((sum, node) => sum + node.projects, 0),
        totalCitations: data.nodes.reduce((sum, node) => sum + node.citations, 0),
        collaborationCount: data.links.length
      };
    }
    
    if (visual.includes('current-view')) {
      const transform = d3.zoomTransform(svg.node());
      exportObj.view = {
        transform: {
          x: transform.x,
          y: transform.y,
          k: transform.k
        },
        visibleNodes: node.filter(d => d3.select(d).style('opacity') === '1').data(),
        visibleLinks: link.filter(d => d3.select(d).style('opacity') === '0.6').data()
      };
    }
    
    return exportObj;
  }
  
  function downloadExport(data, format) {
    let content, filename, type;
    
    switch(format) {
      case 'json':
        content = JSON.stringify(data, null, 2);
        filename = 'research-network.json';
        type = 'application/json';
        break;
        
      case 'csv':
        content = convertToCSV(data);
        filename = 'research-network.csv';
        type = 'text/csv';
        break;
        
      case 'svg':
        content = new XMLSerializer().serializeToString(svg.node());
        filename = 'research-network.svg';
        type = 'image/svg+xml';
        break;
    }
    
    const blob = new Blob([content], { type });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }
  
  function convertToCSV(data) {
    const rows = [];
    
    // Add headers
    if (data.nodes) {
      rows.push(['Node ID', 'Label', 'Group', 'Publications', 'Projects', 'Citations', 'Year', 'Impact']);
      data.nodes.forEach(node => {
        rows.push([
          node.id,
          node.label,
          node.group,
          node.publications,
          node.projects,
          node.citations,
          node.year,
          node.impact
        ]);
      });
    }
    
    if (data.links) {
      rows.push([]); // Empty row as separator
      rows.push(['Source', 'Target', 'Strength', 'Type', 'Year']);
      data.links.forEach(link => {
        rows.push([
          link.source,
          link.target,
          link.strength,
          link.type,
          link.year
        ]);
      });
    }
    
    return rows.map(row => row.join(',')).join('\n');
  }
  
  // Close panels when clicking outside
  document.addEventListener('click', (event) => {
    if (!filterBtn.contains(event.target) && 
        !filterPanel.contains(event.target) &&
        !exportBtn.contains(event.target) &&
        !exportPanel.contains(event.target)) {
      filterPanel.classList.remove('visible');
      exportPanel.classList.remove('visible');
    }
  });
}
</script>

<section class="featured-section card glassy">
  <h2>Recent Updates</h2>
  <div class="update-timeline">
    <div class="update-item card glassy">
      <div class="update-icon icon-ios">
        <img src="/assets/icons/ai.svg" alt="AI Icon" />
      </div>
      <div class="update-date">April 2023</div>
      <div class="update-content">
        <h3>AI Climate Modeling Paper Published</h3>
        <p>New research on neural network applications in climate prediction</p>
        <a href="#" class="update-link btn-secondary">Read More →</a>
      </div>
    </div>
    <div class="update-item card glassy">
      <div class="update-icon icon-ios">
        <img src="/assets/icons/survival-analysis.svg" alt="Survival Analysis Icon" />
      </div>
      <div class="update-date">March 2023</div>
      <div class="update-content">
        <h3>COVID-19 Survival Analysis Project</h3>
        <p>Analyzing factors affecting hospital outcomes using survival models</p>
        <a href="https://github.com/GeoffreyManda/covid-survival-analysis" class="update-link btn-secondary">View Project →</a>
      </div>
    </div>
    <div class="update-item card glassy">
      <div class="update-icon icon-ios">
        <img src="/assets/icons/research.svg" alt="Research Icon" />
      </div>
      <div class="update-date">February 2023</div>
      <div class="update-content">
        <h3>Website Redesign Launched</h3>
        <p>Modern interface with improved navigation and content organization</p>
      </div>
    </div>
  </div>
</section>

<section class="contact-preview card glassy">
  <h2>Let's Collaborate</h2>
  <p>Interested in working together on research, data analysis, or AI projects?</p>
  <a href="contact" class="btn-primary hero-button primary">Contact Me</a>
</section>

<footer class="site-footer card glassy">
  <div class="footer-content">
    <div class="copyright">
      © 2023 Geoffrey Manda
    </div>
    <div class="footer-links">
      <a href="https://github.com/GeoffreyManda" aria-label="GitHub" class="icon-ios">
        <img src="/assets/icons/github-icon.svg" alt="GitHub" />
      </a>
      <a href="https://linkedin.com/" aria-label="LinkedIn" class="icon-ios">
        <img src="/assets/icons/linkedin-icon.svg" alt="LinkedIn" />
      </a>
      <a href="https://twitter.com/" aria-label="Twitter" class="icon-ios">
        <img src="/assets/icons/twitter-icon.svg" alt="Twitter" />
      </a>
    </div>
  </div>
  <div class="license">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">
      <img src="https://img.shields.io/badge/License-CC%20BY--NC--ND%204.0-lightgrey.svg" alt="License: CC BY-NC-ND 4.0" />
    </a>
  </div>
</footer>

</div>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Geoffrey Manda | Data Scientist</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">{&quot;name&quot;=&gt;&quot;Geoffrey Manda&quot;, &quot;github&quot;=&gt;&quot;GeoffreyManda&quot;, &quot;email&quot;=&gt;&quot;your.email@example.com&quot;}</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Statistical analysis, AI research, and epidemiological studies</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
